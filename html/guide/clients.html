<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
  
  <!-- Licensed under the Apache 2.0 License -->
  <link rel="stylesheet" type="text/css" href="../_static/fonts/open-sans/stylesheet.css" />
  <!-- Licensed under the SIL Open Font License -->
  <link rel="stylesheet" type="text/css" href="../_static/fonts/source-serif-pro/source-serif-pro.css" />
  <link rel="stylesheet" type="text/css" href="../_static/css/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="../_static/css/bootstrap-theme.min.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    <title>Low-level clients &mdash; Boto3 Docs 1.18.5 documentation</title>
    
    <link rel="stylesheet" href="../_static/guzzle.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.18.5',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Boto3 Docs 1.18.5 documentation" href="../index.html" />
    <link rel="up" title="Developer guide" href="index.html" />
    <link rel="next" title="Resources" href="resources.html" />
    <link rel="prev" title="Credentials" href="credentials.html" />
  
   

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="resources.html" title="Resources"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="credentials.html" title="Credentials"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Boto3 Docs 1.18.5 documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Developer guide</a> &raquo;</li> 
      </ul>
    </div>
    <div class="container-wrapper">

      <div id="mobile-toggle">
        <a href="#"><span class="glyphicon glyphicon-align-justify" aria-hidden="true"></span></a>
      </div>
  <div id="left-column">
    <div class="sphinxsidebar"><a href="
    ../index.html" class="text-logo">Boto3 Docs 1.18.5 documentation</a><div class="sidebar-block">
  <div class="sidebar-wrapper">
    <h2>Table Of Contents</h2>
  </div>
  <div class="sidebar-toc">
    
    
      <ul>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="sqs.html">A sample tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Code examples</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Developer guide</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html#sdk-features">SDK features</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="credentials.html">Credentials</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="">Low-level clients</a></li>
<li class="toctree-l3"><a class="reference internal" href="resources.html">Resources</a></li>
<li class="toctree-l3"><a class="reference internal" href="session.html">Session</a></li>
<li class="toctree-l3"><a class="reference internal" href="collections.html">Collections</a></li>
<li class="toctree-l3"><a class="reference internal" href="paginators.html">Paginators</a></li>
<li class="toctree-l3"><a class="reference internal" href="error-handling.html">Error handling</a></li>
<li class="toctree-l3"><a class="reference internal" href="retries.html">Retries</a></li>
<li class="toctree-l3"><a class="reference internal" href="events.html">Extensibility guide</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#tools">Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#migrations">Migrations</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="security.html">Security</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reference/services/index.html">Available services</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reference/core/index.html">Core references</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reference/customizations/index.html">Customization references</a></li>
</ul>

    
  </div>
</div>
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <div id="main-search">
      <form class="form-inline" action="../search.html" method="GET" role="form">
        <div class="input-group">
          <input name="q" type="text" class="form-control" placeholder="Search...">
        </div>
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div>
      
    </div>
  </div>
        <div id="right-column">
          

          <div role="navigation" aria-label="breadcrumbs navigation">
            <ol class="breadcrumb">
              <li><a href="../index.html">Docs</a></li>
              
                <li><a href="index.html">Developer guide</a></li>
              
              <li>Low-level clients</li>
            </ol>
          </div>
          
<!--REGION_DISCLAIMER_DO_NOT_REMOVE-->
          <div class="document clearer body">
            
  <div class="section" id="low-level-clients">
<span id="guide-clients"></span><h1>Low-level clients<a class="headerlink" href="#low-level-clients" title="Permalink to this headline">¶</a></h1>
<p>Clients provide a low-level interface to AWS whose methods map close to 1:1
with service APIs. All service operations are supported by clients. Clients
are generated from a JSON service definition file.</p>
<div class="section" id="creating-clients">
<h2>Creating clients<a class="headerlink" href="#creating-clients" title="Permalink to this headline">¶</a></h2>
<p>Clients are created in a similar fashion to resources:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">boto3</span>

<span class="c1"># Create a low-level client with the service name</span>
<span class="n">sqs</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;sqs&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>It is also possible to access the low-level client from an existing
resource:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Create the resource</span>
<span class="n">sqs_resource</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">resource</span><span class="p">(</span><span class="s1">&#39;sqs&#39;</span><span class="p">)</span>

<span class="c1"># Get the client from the resource</span>
<span class="n">sqs</span> <span class="o">=</span> <span class="n">sqs_resource</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">client</span>
</pre></div>
</div>
</div>
<div class="section" id="service-operations">
<h2>Service operations<a class="headerlink" href="#service-operations" title="Permalink to this headline">¶</a></h2>
<p>Service operations map to client methods of the same name and provide
access to the same operation parameters via keyword arguments:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Make a call using the low-level client</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">sqs</span><span class="o">.</span><span class="n">send_message</span><span class="p">(</span><span class="n">QueueUrl</span><span class="o">=</span><span class="s1">&#39;...&#39;</span><span class="p">,</span> <span class="n">MessageBody</span><span class="o">=</span><span class="s1">&#39;...&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>As can be seen above, the method arguments map directly to the associated
<a class="reference external" href="http://docs.aws.amazon.com/AWSSimpleQueueService/latest/APIReference/API_SendMessage.html">SQS API</a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The method names have been snake-cased for better looking Python code.</p>
<p class="last">Parameters <strong>must</strong> be sent as keyword arguments. They will not work
as positional arguments.</p>
</div>
</div>
<div class="section" id="handling-responses">
<h2>Handling responses<a class="headerlink" href="#handling-responses" title="Permalink to this headline">¶</a></h2>
<p>Responses are returned as python dictionaries. It is up to you to traverse
or otherwise process the response for the data you need, keeping in mind
that responses may not always include all of the expected data. In the
example below, <tt class="docutils literal"><span class="pre">response.get('QueueUrls',</span> <span class="pre">[])</span></tt> is used to ensure that a
list is always returned, even when the response has no key <tt class="docutils literal"><span class="pre">'QueueUrls'</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># List all your queues</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">sqs</span><span class="o">.</span><span class="n">list_queues</span><span class="p">()</span>
<span class="k">for</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;QueueUrls&#39;</span><span class="p">,</span> <span class="p">[]):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">response</span></tt> in the example above looks something like this:</p>
<div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;QueueUrls&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;http://url1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;http://url2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;http://url3&quot;</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="waiters">
<h2>Waiters<a class="headerlink" href="#waiters" title="Permalink to this headline">¶</a></h2>
<p>Waiters use a client's service operations to poll the status of an AWS resource
and suspend execution until the AWS resource reaches the state that the
waiter is polling for or a failure occurs while polling.
Using clients, you can learn the name of each waiter that a client has access
to:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">boto3</span>

<span class="n">s3</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
<span class="n">sqs</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;sqs&#39;</span><span class="p">)</span>

<span class="c1"># List all of the possible waiters for both clients</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;s3 waiters:&quot;</span><span class="p">)</span>
<span class="n">s3</span><span class="o">.</span><span class="n">waiter_names</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;sqs waiters:&quot;</span><span class="p">)</span>
<span class="n">sqs</span><span class="o">.</span><span class="n">waiter_names</span>
</pre></div>
</div>
<p>Note if a client does not have any waiters, it will return an empty list when
accessing its <tt class="docutils literal"><span class="pre">waiter_names</span></tt> attribute:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>s3 waiters:
[u&#39;bucket_exists&#39;, u&#39;bucket_not_exists&#39;, u&#39;object_exists&#39;, u&#39;object_not_exists&#39;]
sqs waiters:
[]
</pre></div>
</div>
<p>Using a client's <tt class="docutils literal"><span class="pre">get_waiter()</span></tt> method, you can obtain a specific waiter
from its list of possible waiters:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Retrieve waiter instance that will wait till a specified</span>
<span class="c1"># S3 bucket exists</span>
<span class="n">s3_bucket_exists_waiter</span> <span class="o">=</span> <span class="n">s3</span><span class="o">.</span><span class="n">get_waiter</span><span class="p">(</span><span class="s1">&#39;bucket_exists&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Then to actually start waiting, you must call the waiter's <tt class="docutils literal"><span class="pre">wait()</span></tt> method
with the method's appropriate parameters passed in:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Begin waiting for the S3 bucket, mybucket, to exist</span>
<span class="n">s3_bucket_exists_waiter</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">Bucket</span><span class="o">=</span><span class="s1">&#39;mybucket&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="multithreading-or-multiprocessing-with-clients">
<h2>Multithreading or multiprocessing with clients<a class="headerlink" href="#multithreading-or-multiprocessing-with-clients" title="Permalink to this headline">¶</a></h2>
<p>Unlike Resources and Sessions, clients <strong>are</strong> generally <em>thread-safe</em>.
There are some caveats, defined below, to be aware of though.</p>
<div class="section" id="caveats">
<h3>Caveats<a class="headerlink" href="#caveats" title="Permalink to this headline">¶</a></h3>
<p><strong>Multi-Processing:</strong> While clients are <em>thread-safe</em>, they cannot be
shared across processes due to their networking implementation. Doing so
may lead to incorrect response ordering when calling services.</p>
<p><strong>Shared Metadata:</strong> Clients expose metadata to the end user through a
few attributes (namely <tt class="docutils literal"><span class="pre">meta</span></tt>, <tt class="docutils literal"><span class="pre">exceptions</span></tt> and <tt class="docutils literal"><span class="pre">waiter_names</span></tt>).
These are safe to read but any mutations should not be considered
thread-safe.</p>
<p><strong>Custom</strong> <a class="reference external" href="https://botocore.amazonaws.com/v1/documentation/api/latest/topics/events.html">Botocore Events</a><strong>:</strong> Botocore (the library Boto3 is
built on) allows advanced users to provide their own custom event hooks
which may interact with boto3’s client. The majority of users will not
need to use these interfaces, but those that do should no longer
consider their clients thread-safe without careful review.</p>
</div>
<div class="section" id="general-example">
<h3>General Example<a class="headerlink" href="#general-example" title="Permalink to this headline">¶</a></h3>
<div class="code python highlight-python"><div class="highlight"><pre><span></span>import boto3.session
from concurrent.futures import ThreadPoolExecutor

def do_s3_task(client, task_definition):
    # Put your thread-safe code here

def my_workflow():
    # Create a session and use it to make our client
    session = boto3.session.Session()
    s3_client = session.client(&#39;s3&#39;)

    # Define some work to be done, this can be anything
    my_tasks = [ ... ]

    # Dispatch work tasks with our s3_client
    with ThreadPoolExecutor(max_workers=8) as executor:
        futures = [executor.submit(do_s3_task, s3_client, task) for task in my_tasks]
</pre></div>
</div>
</div>
</div>
</div>


          </div>
            
  <div class="footer-relations">
    
      <div class="pull-left">
        <a class="btn btn-default" href="credentials.html" title="previous chapter (use the left arrow)">Credentials</a>
      </div>
    
      <div class="pull-right">
        <a class="btn btn-default" href="resources.html" title="next chapter (use the right arrow)">Resources</a>
      </div>
    </div>
    <div class="clearer"></div>
  
        </div>
        <div class="clearfix"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="resources.html" title="Resources"
             >next</a> |</li>
        <li class="right" >
          <a href="credentials.html" title="Credentials"
             >previous</a> |</li>
        <li><a href="../index.html">Boto3 Docs 1.18.5 documentation</a> &raquo;</li>
          <li><a href="index.html" >Developer guide</a> &raquo;</li> 
      </ul>
    </div>
<div class="footer">
    <script type="text/javascript" src="../_static/shortbreadv1.js"></script>
    <script type="text/javascript">
            const shortbread = AWSCShortbread({
                domain: ".amazonaws.com",
});
            shortbread.checkForCookieConsent();
    </script>
    <a href="http://aws.amazon.com/privacy">Privacy</a> | <a href="http://aws.amazon.com/terms">Site Terms</a> | <a
        href="#" onclick="shortbread.customizeCookies();">Cookie preferences</a> |
    &copy; Copyright 2021, Amazon Web Services, Inc. Created using <a href="https://www.sphinx-doc.org/">Sphinx</a>.
</div>
  </body>
</html>